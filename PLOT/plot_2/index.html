
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../plot_1/">
      
      
        <link rel="next" href="../plot_3/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.2">
    
    
      
        <title>1-2. 箱线图 - Bioinformatic Tutorial (Daxing Research)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7bf56d0a.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Bioinformatic Tutorial (Daxing Research)" class="md-header__button md-logo" aria-label="Bioinformatic Tutorial (Daxing Research)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Bioinformatic Tutorial (Daxing Research)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1-2. 箱线图
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/Starlitnightly/bioinformatic_tutorial" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Bioinformatic Tutorial (Daxing Research)" class="md-nav__button md-logo" aria-label="Bioinformatic Tutorial (Daxing Research)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Bioinformatic Tutorial (Daxing Research)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Starlitnightly/bioinformatic_tutorial" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        写在前面
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          基础环境配置
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          基础环境配置
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CONFIG/config_1/" class="md-nav__link">
        配置1. Python环境
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CONFIG/config_2/" class="md-nav__link">
        配置2. Linux环境
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CONFIG/config_3/" class="md-nav__link">
        配置3. R语言环境
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          RNA-seq上游分析
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          RNA-seq上游分析
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../RNASEQUP/rnasequp_1/" class="md-nav__link">
        1-1. 环境配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../RNASEQUP/rnasequp_2/" class="md-nav__link">
        1-2. 上游分析全教程
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          RNA-seq下游分析
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          RNA-seq下游分析
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../RNASEQ/rnaseq_1/" class="md-nav__link">
        2-1. 环境配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../RNASEQ/rnaseq_2/" class="md-nav__link">
        2-2. 差异表达基因(DEG)分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../RNASEQ/rnaseq_3/" class="md-nav__link">
        2-3. 通路富集分析(GSEA)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          单细胞样本对齐
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          单细胞样本对齐
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SCGLUE/scglue_1/" class="md-nav__link">
        3-1. 环境配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SCGLUE/scglue_2/" class="md-nav__link">
        3-2. 数据预处理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SCGLUE/scglue_3/" class="md-nav__link">
        3-3. 模型准备
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SCGLUE/scglue_4/" class="md-nav__link">
        3-4. 模型训练
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SCGLUE/scglue_5/" class="md-nav__link">
        3-5. 对齐细胞
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          MOFA单细胞多组学因子分析
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          MOFA单细胞多组学因子分析
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MOFA/mofa_1/" class="md-nav__link">
        4-1. 环境配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MOFA/mofa_2/" class="md-nav__link">
        4-2. 单细胞样本对齐
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MOFA/mofa_3/" class="md-nav__link">
        4-3. scRNA-seq数据处理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MOFA/mofa_4/" class="md-nav__link">
        4-4. scATAC-seq数据处理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MOFA/mofa_5/" class="md-nav__link">
        4-5. MOFA模型构建
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MOFA/mofa_6/" class="md-nav__link">
        4-6. MOFA下游分析-R语言环节
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MOFA/mofa_7/" class="md-nav__link">
        4-7. MOFA下游分析-Python环节
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          TMT蛋白组学分析
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          TMT蛋白组学分析
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../TMT/tmt_1/" class="md-nav__link">
        5-1. 环境配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../TMT/tmt_2/" class="md-nav__link">
        5-2. TMT蛋白组学上游分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../TMT/tmt_3/" class="md-nav__link">
        5-3. TMT蛋白组学下游分析
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          多组学分析
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          多组学分析
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MultiOMIC/book-1/" class="md-nav__link">
        6-1. 数据准备
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MultiOMIC/book-2/" class="md-nav__link">
        6-2. GLUE多组学整合
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MultiOMIC/book-3/" class="md-nav__link">
        6-3. 细胞亚群分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MultiOMIC/book-4/" class="md-nav__link">
        6-4. 差异表达分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MultiOMIC/book-5/" class="md-nav__link">
        6-5. 细胞通讯分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MultiOMIC/book-6/" class="md-nav__link">
        6-6. 动态调控分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MultiOMIC/book-7/" class="md-nav__link">
        6-7. 转录因子网络
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          Python可视化
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Python可视化
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_1/" class="md-nav__link">
        1-1. 火山图
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          1-2. 箱线图
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        1-2. 箱线图
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 基因表达图（箱线图）
  </a>
  
    <nav class="md-nav" aria-label="2. 基因表达图（箱线图）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 画图配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 数据准备
  </a>
  
    <nav class="md-nav" aria-label="2.2 数据准备">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221" class="md-nav__link">
    2.2.1 导入数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222" class="md-nav__link">
    2.2.2 数据预处理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223" class="md-nav__link">
    2.2.3 数据内容
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3 箱线图绘制
  </a>
  
    <nav class="md-nav" aria-label="2.3 箱线图绘制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231" class="md-nav__link">
    2.3.1 定义画板
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" class="md-nav__link">
    2.3.2 基本箱线图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#233" class="md-nav__link">
    2.3.3 更改箱线图的颜色
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#234" class="md-nav__link">
    2.3.4 添加抖动的散点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#235" class="md-nav__link">
    2.3.5 修改坐标
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#236" class="md-nav__link">
    2.3.6 增加图注
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#237" class="md-nav__link">
    2.3.7 坐标轴修改
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    2.4 小结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_3/" class="md-nav__link">
        1-3. 热图(聚类)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          视网膜母细胞瘤分析教程
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          视网膜母细胞瘤分析教程
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rb_tutorial/rb_tutorial.md" class="md-nav__link">
        Base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rb_tutorial/Tutorial_1_preprocess.ipynb" class="md-nav__link">
        Tutorial_1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rb_tutorial/Tutorial_2_filtered_qc.ipynb" class="md-nav__link">
        Tutorial_2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rb_tutorial/Tutorial_3_glue.ipynb" class="md-nav__link">
        Tutorial_3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rb_tutorial/Tutorial_4_scbasset.ipynb" class="md-nav__link">
        Tutorial_4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rb_tutorial/Tutorial_5_analysis1.ipynb" class="md-nav__link">
        Tutorial_5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rb_tutorial/Tutorial_6_analysis2.ipynb" class="md-nav__link">
        Tutorial_6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rb_tutorial/Tutorial_7_STER_cell.ipynb" class="md-nav__link">
        Tutorial_7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rb_tutorial/Tutorial_8_kineic_photo.ipynb" class="md-nav__link">
        Tutorial_8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rb_tutorial/Tutorial_9_cellphonedb.ipynb" class="md-nav__link">
        Tutorial_9
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 基因表达图（箱线图）
  </a>
  
    <nav class="md-nav" aria-label="2. 基因表达图（箱线图）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 画图配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 数据准备
  </a>
  
    <nav class="md-nav" aria-label="2.2 数据准备">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221" class="md-nav__link">
    2.2.1 导入数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222" class="md-nav__link">
    2.2.2 数据预处理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223" class="md-nav__link">
    2.2.3 数据内容
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3 箱线图绘制
  </a>
  
    <nav class="md-nav" aria-label="2.3 箱线图绘制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231" class="md-nav__link">
    2.3.1 定义画板
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" class="md-nav__link">
    2.3.2 基本箱线图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#233" class="md-nav__link">
    2.3.3 更改箱线图的颜色
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#234" class="md-nav__link">
    2.3.4 添加抖动的散点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#235" class="md-nav__link">
    2.3.5 修改坐标
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#236" class="md-nav__link">
    2.3.6 增加图注
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#237" class="md-nav__link">
    2.3.7 坐标轴修改
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    2.4 小结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  
                  

  
  


  <h1>1-2. 箱线图</h1>

<h2 id="2">2. 基因表达图（箱线图）</h2>
<p>带来的第二个图，是一个比较常见的箱线图，seaborn虽然也能用一行代码画出来，但是我想改成空心的就比较麻烦，并且可能由于包的版本不兼容，
所以导致我们最后画出来的图难以修改，所以在这里，我们将使用matplotlib从头画一遍。</p>
<p><strong>数据下载地址：https://github.com/Starlitnightly/bioinformatic_tutorial/tree/main/PLOT/data/data_exp.csv</strong></p>
<h3 id="21">2.1 画图配置</h3>
<p>我们首先配置一下jupyter的显示效果，这里用了retina作为显示的图片格式，其次导入了一些常见的包，并提供了一个色卡</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="linenos" data-linenos=" 2 "></span><span class="o">%</span><span class="n">config</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">figure_format</span> <span class="o">=</span> <span class="s1">&#39;retina&#39;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="c1">#导入包，我有一个习惯就是把导入的包的版本号同时打印出来，这样别人出问题的时候，也能知道到底是哪个版本没对上</span>
<span class="linenos" data-linenos=" 5 "></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos" data-linenos=" 6 "></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="linenos" data-linenos=" 7 "></span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="linenos" data-linenos=" 8 "></span><span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matplotlib(Ver): &#39;</span><span class="p">,</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="linenos" data-linenos="12 "></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;seaborn(Ver): &#39;</span><span class="p">,</span><span class="n">sns</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos" data-linenos="15 "></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;numpy(Ver): &#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos" data-linenos="18 "></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pandas(Ver): &#39;</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="kn">import</span> <span class="nn">random</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="c1">#色卡，这里提供一个我画图常用的色卡，我一般画图的颜色都是从里面选取的</span>
<span class="linenos" data-linenos="23 "></span><span class="n">sc_color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#7CBB5F&#39;</span><span class="p">,</span><span class="s1">&#39;#368650&#39;</span><span class="p">,</span><span class="s1">&#39;#A499CC&#39;</span><span class="p">,</span><span class="s1">&#39;#5E4D9A&#39;</span><span class="p">,</span><span class="s1">&#39;#78C2ED&#39;</span><span class="p">,</span><span class="s1">&#39;#866017&#39;</span><span class="p">,</span> <span class="s1">&#39;#9F987F&#39;</span><span class="p">,</span><span class="s1">&#39;#E0DFED&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="24 "></span> <span class="s1">&#39;#EF7B77&#39;</span><span class="p">,</span> <span class="s1">&#39;#279AD7&#39;</span><span class="p">,</span><span class="s1">&#39;#F0EEF0&#39;</span><span class="p">,</span> <span class="s1">&#39;#1F577B&#39;</span><span class="p">,</span> <span class="s1">&#39;#A56BA7&#39;</span><span class="p">,</span> <span class="s1">&#39;#E0A7C8&#39;</span><span class="p">,</span> <span class="s1">&#39;#E069A6&#39;</span><span class="p">,</span> <span class="s1">&#39;#941456&#39;</span><span class="p">,</span> <span class="s1">&#39;#FCBC10&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="25 "></span> <span class="s1">&#39;#EAEFC5&#39;</span><span class="p">,</span> <span class="s1">&#39;#01A0A7&#39;</span><span class="p">,</span> <span class="s1">&#39;#75C8CC&#39;</span><span class="p">,</span> <span class="s1">&#39;#F0D7BC&#39;</span><span class="p">,</span> <span class="s1">&#39;#D5B26C&#39;</span><span class="p">,</span> <span class="s1">&#39;#D5DA48&#39;</span><span class="p">,</span> <span class="s1">&#39;#B6B812&#39;</span><span class="p">,</span> <span class="s1">&#39;#9DC3C3&#39;</span><span class="p">,</span> <span class="s1">&#39;#A89C92&#39;</span><span class="p">,</span> <span class="s1">&#39;#FEE00C&#39;</span><span class="p">,</span> <span class="s1">&#39;#FEF2A1&#39;</span><span class="p">]</span>
<span class="linenos" data-linenos="26 "></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="linenos" data-linenos="27 "></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sc_color</span><span class="p">)):</span>
<span class="linenos" data-linenos="28 "></span>    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">sc_color</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="linenos" data-linenos="29 "></span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>matplotlib(Ver):  3.5.1
<span class="linenos" data-linenos="2 "></span>seaborn(Ver):  0.11.2
<span class="linenos" data-linenos="3 "></span>numpy(Ver):  1.23.4
<span class="linenos" data-linenos="4 "></span>pandas(Ver):  1.5.1
</code></pre></div>
<p><img alt="png" src="../plot_2.assets/output_1_1.png" /></p>
<h3 id="22">2.2 数据准备</h3>
<h4 id="221">2.2.1 导入数据</h4>
<p>在这里，我们导入了绘制箱线图需要的数据，这里的数据是来源于正常组织与癌组织的两个基因的表达情况。</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">#设置文件路径</span>
<span class="linenos" data-linenos="2 "></span><span class="n">current_path</span><span class="o">=</span><span class="s1">&#39;/home/xiongyy/analysis/PLOT/&#39;</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">#使用read_csv导入csv文件</span>
<span class="linenos" data-linenos="4 "></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">current_path</span><span class="o">+</span><span class="s1">&#39;data/data_exp.csv&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>gene</th>
      <th>X</th>
      <th>cancer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.025118</td>
      <td>LARP6</td>
      <td>0.005022</td>
      <td>BRCA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.292682</td>
      <td>LARP6</td>
      <td>0.007507</td>
      <td>BRCA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.692980</td>
      <td>LARP6</td>
      <td>0.005022</td>
      <td>BRCA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.436567</td>
      <td>LARP6</td>
      <td>0.007507</td>
      <td>BRCA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.890317</td>
      <td>LARP6</td>
      <td>0.005022</td>
      <td>BRCA</td>
    </tr>
  </tbody>
</table>

</div>

<h4 id="222">2.2.2 数据预处理</h4>
<p>我们前面导入的数据，还不满足我们箱线图绘制的格式，我们对数据进行初步处理，我们目标的箱线图：</p>
<ul>
<li>1）最终是透明的内框，并且还有着部分散点的分布，</li>
<li>2）此外，分布的数据点应该呈现抖动，并不是全部都在一条直线上</li>
<li>3）此外，对于数据点而言，我们可以随机选取20个作为代表进而反应数据总体特征。</li>
</ul>
<p>为了满足这些需求，要求我们对数据需要进行一些预处理</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="c1">#获取箱子位置的函数，如果是两个箱子，那么其应该是在坐标两侧根据width分隔</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">#如果是三个箱子，那么坐标的位置箱子width各占一半，再根据width进行分隔</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">def</span> <span class="nf">ticks_range</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">width</span><span class="p">):</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="n">nticks</span><span class="o">=</span><span class="p">[]</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="n">pticks</span><span class="o">=</span><span class="p">[]</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="n">start</span><span class="o">=-</span><span class="p">(</span><span class="n">x</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="n">end</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="n">nticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="n">width</span><span class="p">)</span>
<span class="linenos" data-linenos="10 "></span>        <span class="n">start</span><span class="o">+=</span><span class="n">width</span>
<span class="linenos" data-linenos="11 "></span>        <span class="n">pticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">width</span><span class="p">)</span>
<span class="linenos" data-linenos="12 "></span>        <span class="n">end</span><span class="o">-=</span><span class="n">width</span>
<span class="linenos" data-linenos="13 "></span>    <span class="k">if</span> <span class="n">x</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
<span class="linenos" data-linenos="14 "></span>        <span class="n">ticks</span><span class="o">=</span><span class="n">nticks</span><span class="o">+</span><span class="n">pticks</span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">elif</span> <span class="n">x</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
<span class="linenos" data-linenos="16 "></span>        <span class="n">ticks</span><span class="o">=</span><span class="n">nticks</span><span class="o">+</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">pticks</span>
<span class="linenos" data-linenos="17 "></span>    <span class="k">return</span> <span class="n">ticks</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="c1">#获取需要分割的数据</span>
<span class="linenos" data-linenos=" 2 "></span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;gene&#39;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="n">hue_datas</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]))</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1">#获取箱线图的横坐标</span>
<span class="linenos" data-linenos=" 6 "></span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;cancer&#39;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="n">ticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="c1">#在这个数据中，我们有6个不同的癌症，每个癌症都有2个基因（2个箱子）</span>
<span class="linenos" data-linenos="10 "></span><span class="c1">#所以我们需要得到每一个基因的6个箱线图位置，6个散点图的抖动</span>
<span class="linenos" data-linenos="11 "></span><span class="n">plot_data1</span><span class="o">=</span><span class="p">{}</span><span class="c1">#字典里的每一个元素就是每一个基因的所有值</span>
<span class="linenos" data-linenos="12 "></span><span class="n">plot_data_random1</span><span class="o">=</span><span class="p">{}</span><span class="c1">#字典里的每一个元素就是每一个基因的随机20个值</span>
<span class="linenos" data-linenos="13 "></span><span class="n">plot_data_xs1</span><span class="o">=</span><span class="p">{}</span><span class="c1">#字典里的每一个元素就是每一个基因的20个抖动值</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="c1">#箱子的参数</span>
<span class="linenos" data-linenos="17 "></span><span class="n">width</span><span class="o">=</span><span class="mf">0.6</span>
<span class="linenos" data-linenos="18 "></span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span>
<span class="linenos" data-linenos="19 "></span><span class="k">for</span> <span class="n">hue_data</span><span class="p">,</span><span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">,</span><span class="n">ticks_range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">),</span><span class="n">width</span><span class="p">)):</span>
<span class="linenos" data-linenos="20 "></span>    <span class="n">data_a</span><span class="o">=</span><span class="p">[]</span>
<span class="linenos" data-linenos="21 "></span>    <span class="n">data_a_random</span><span class="o">=</span><span class="p">[]</span>
<span class="linenos" data-linenos="22 "></span>    <span class="n">data_a_xs</span><span class="o">=</span><span class="p">[]</span>
<span class="linenos" data-linenos="23 "></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">))):</span>
<span class="linenos" data-linenos="24 "></span>        <span class="n">test_data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[((</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]</span><span class="o">==</span><span class="n">hue_data</span><span class="p">)),</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="linenos" data-linenos="25 "></span>        <span class="n">data_a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="linenos" data-linenos="26 "></span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">:</span>
<span class="linenos" data-linenos="27 "></span>            <span class="n">data_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="linenos" data-linenos="28 "></span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos" data-linenos="29 "></span>            <span class="n">data_size</span><span class="o">=</span><span class="mi">20</span>
<span class="linenos" data-linenos="30 "></span>        <span class="n">random_data</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span><span class="n">data_size</span><span class="p">)</span>
<span class="linenos" data-linenos="31 "></span>        <span class="n">data_a_random</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_data</span><span class="p">)</span>
<span class="linenos" data-linenos="32 "></span>        <span class="n">data_a_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">)</span><span class="o">+</span><span class="n">num</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_data</span><span class="p">)))</span>
<span class="linenos" data-linenos="33 "></span>    <span class="c1">#data_a=np.array(data_a)</span>
<span class="linenos" data-linenos="34 "></span>    <span class="n">data_a_random</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_a_random</span><span class="p">)</span>
<span class="linenos" data-linenos="35 "></span>    <span class="n">plot_data1</span><span class="p">[</span><span class="n">hue_data</span><span class="p">]</span><span class="o">=</span><span class="n">data_a</span> 
<span class="linenos" data-linenos="36 "></span>    <span class="n">plot_data_random1</span><span class="p">[</span><span class="n">hue_data</span><span class="p">]</span><span class="o">=</span><span class="n">data_a_random</span>
<span class="linenos" data-linenos="37 "></span>    <span class="n">plot_data_xs1</span><span class="p">[</span><span class="n">hue_data</span><span class="p">]</span><span class="o">=</span><span class="n">data_a_xs</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>/tmp/ipykernel_2015538/3231799147.py:34: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify &#39;dtype=object&#39; when creating the ndarray.
<span class="linenos" data-linenos="2 "></span>  data_a_random=np.array(data_a_random)
</code></pre></div>
<h4 id="223">2.2.3 数据内容</h4>
<p>看到这里，你可能会好奇我们最终需要的数据的格式，所以我们在这里展示一下内容</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">#随机选取的基因表达的20个点，不足就按实际数量</span>
<span class="linenos" data-linenos="2 "></span><span class="n">plot_data_random1</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>{&#39;NMT2&#39;: array([list([0.37795785, 0.27541786, 0.88073957, 0.109331414, 0.14605017, 0.33756697, 0.22671773, 0.17579721, 0.12098043, 0.24228325, 0.35897264, 0.15303418, 0.22052813, 0.17295828, 0.22442392, 0.083016165, 0.16161942, 0.2860996, 0.3563737, 0.75383836]),
<span class="linenos" data-linenos=" 2 "></span>        list([0.2960564, 0.34701174, 0.22288272, 0.27955008, 0.29048824, 0.53350616, 0.2977331, 0.21958554, 0.54499495, 0.14102575, 0.22897784, 0.3444893, 0.18192068, 0.18657017, 0.4768225, 0.42410743, 0.27801016, 0.31606138, 0.3117901, 0.17937037]),
<span class="linenos" data-linenos=" 3 "></span>        list([0.28256357, 0.27863076, 0.32315785, 0.28638503, 0.29269722, 0.44685376, 0.15580301, 0.59544134, 0.5576201, 0.60528725, 0.36198327, 0.42272118, 0.44268417, 0.3033382, 0.36654335, 0.15873444, 0.13681513, 0.55246353, 0.43693826, 0.4463024]),
<span class="linenos" data-linenos=" 4 "></span>        list([0.4950356, 0.25468516, 0.39453077, 0.4977675, 0.4584297, 0.3095615, 0.23717825, 0.2777065, 0.3856361, 0.42436302, 0.41992697, 0.21360298, 0.5722139, 0.3872121, 0.27247706, 0.778798, 0.46502548, 0.99884504, 0.3324567, 1.406605]),
<span class="linenos" data-linenos=" 5 "></span>        list([0.071582735, 0.2773015, 0.21485995, 0.6302785, 0.119776785, 0.12416972, 0.71442455, 0.5875753, 0.27185702, 0.73937124, 0.45079365, 0.6939412, 1.3797874, 0.05779783, 0.077312745, 0.5374434, 1.2123644, 0.080287464, 0.59965944, 0.89721596]),
<span class="linenos" data-linenos=" 6 "></span>        list([1.1181873, 0.7488404, 0.6892076, 0.96673995, 0.3901763, 0.8148026, 0.24977234, 0.77059096])],
<span class="linenos" data-linenos=" 7 "></span>       dtype=object),
<span class="linenos" data-linenos=" 8 "></span> &#39;LARP6&#39;: array([[0.26663086, 0.4534693 , 0.4962684 , 0.3696553 , 0.16640535,
<span class="linenos" data-linenos=" 9 "></span>         0.5945257 , 0.34436983, 0.13818717, 0.14950922, 0.43393594,
<span class="linenos" data-linenos="10 "></span>         0.21716161, 0.6184434 , 0.15484777, 0.40053862, 1.1802497 ,
<span class="linenos" data-linenos="11 "></span>         0.91877025, 0.48785472, 0.13559689, 0.36805725, 0.4282769 ],
<span class="linenos" data-linenos="12 "></span>        [0.13492325, 0.30066812, 0.1573636 , 0.24993187, 0.24952887,
<span class="linenos" data-linenos="13 "></span>         0.25194097, 0.10962456, 0.19897264, 0.2623272 , 0.17964298,
<span class="linenos" data-linenos="14 "></span>         0.24192365, 0.573069  , 0.41306177, 0.18872675, 0.13251328,
<span class="linenos" data-linenos="15 "></span>         0.25806028, 0.21604547, 0.22405122, 0.15059954, 0.18608057],
<span class="linenos" data-linenos="16 "></span>        [0.1517605 , 0.17523314, 0.22887933, 0.13393931, 0.24386054,
<span class="linenos" data-linenos="17 "></span>         0.16648555, 0.33538806, 0.16384634, 0.2948541 , 0.27431667,
<span class="linenos" data-linenos="18 "></span>         0.3012724 , 0.45861584, 0.3953598 , 0.5722096 , 0.2758698 ,
<span class="linenos" data-linenos="19 "></span>         0.32652286, 0.19570212, 0.43852648, 0.26332474, 0.20716491],
<span class="linenos" data-linenos="20 "></span>        [0.6313702 , 0.4608215 , 0.44257793, 0.31416482, 0.63187593,
<span class="linenos" data-linenos="21 "></span>         0.44123918, 0.9992249 , 0.44345164, 0.50196874, 0.6279961 ,
<span class="linenos" data-linenos="22 "></span>         0.59003794, 0.38347223, 0.57159567, 0.3035877 , 0.34285924,
<span class="linenos" data-linenos="23 "></span>         0.38121685, 0.33689326, 0.6732604 , 0.2845916 , 0.43149632],
<span class="linenos" data-linenos="24 "></span>        [0.10478216, 0.07572417, 0.525072  , 0.7260189 , 0.03937381,
<span class="linenos" data-linenos="25 "></span>         0.06117774, 0.07444061, 0.7951785 , 0.40323076, 0.07680393,
<span class="linenos" data-linenos="26 "></span>         0.33815736, 0.27687255, 0.06861357, 0.1340717 , 0.20814958,
<span class="linenos" data-linenos="27 "></span>         0.11550406, 0.09938479, 0.16005202, 0.62962806, 0.47774434],
<span class="linenos" data-linenos="28 "></span>        [0.2702731 , 0.4044987 , 0.5353266 , 0.5068418 , 0.20318377,
<span class="linenos" data-linenos="29 "></span>         0.8557912 , 0.99112743, 0.26646388, 0.9942343 , 0.57209545,
<span class="linenos" data-linenos="30 "></span>         0.6982051 , 0.5849126 , 0.9300213 , 0.3334058 , 0.9433559 ,
<span class="linenos" data-linenos="31 "></span>         0.388473  , 0.3901763 , 0.35293317, 0.17759521, 1.2401689 ]])}
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">#随机选取的基因表达的20个点的抖动值</span>
<span class="linenos" data-linenos="2 "></span><span class="n">plot_data_xs1</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>{&#39;NMT2&#39;: [array([-0.47284514, -0.44891401, -0.32331639, -0.41231328, -0.36586341,
<span class="linenos" data-linenos=" 2 "></span>         -0.44001331, -0.35033951, -0.42538457, -0.41340496, -0.39530965,
<span class="linenos" data-linenos=" 3 "></span>         -0.43871626, -0.36234619, -0.39192393, -0.44912113, -0.32447731,
<span class="linenos" data-linenos=" 4 "></span>         -0.42498009, -0.38851615, -0.37209075, -0.37514903, -0.44121436]),
<span class="linenos" data-linenos=" 5 "></span>  array([1.54686881, 1.61459837, 1.59121783, 1.56513427, 1.57234645,
<span class="linenos" data-linenos=" 6 "></span>         1.60197463, 1.58282829, 1.65009669, 1.53563441, 1.50331457,
<span class="linenos" data-linenos=" 7 "></span>         1.59302432, 1.63272805, 1.57833975, 1.63136204, 1.58915594,
<span class="linenos" data-linenos=" 8 "></span>         1.58105733, 1.62657699, 1.60585938, 1.62236999, 1.60603639]),
<span class="linenos" data-linenos=" 9 "></span>  array([3.61956321, 3.57702161, 3.62973707, 3.56568314, 3.58234698,
<span class="linenos" data-linenos="10 "></span>         3.55882109, 3.66530238, 3.63411081, 3.63845206, 3.62245549,
<span class="linenos" data-linenos="11 "></span>         3.59397995, 3.62907509, 3.61004752, 3.56543153, 3.61582377,
<span class="linenos" data-linenos="12 "></span>         3.5704744 , 3.63053649, 3.59619724, 3.53824556, 3.56696804]),
<span class="linenos" data-linenos="13 "></span>  array([5.54373018, 5.58369353, 5.6200316 , 5.53083547, 5.64717998,
<span class="linenos" data-linenos="14 "></span>         5.53699936, 5.55636598, 5.61911217, 5.59307206, 5.60967152,
<span class="linenos" data-linenos="15 "></span>         5.61436155, 5.61179638, 5.56237508, 5.65675037, 5.6056467 ,
<span class="linenos" data-linenos="16 "></span>         5.6546354 , 5.58514043, 5.63909014, 5.56538788, 5.60542317]),
<span class="linenos" data-linenos="17 "></span>  array([7.65015261, 7.52874069, 7.59254934, 7.54112262, 7.59273175,
<span class="linenos" data-linenos="18 "></span>         7.62261543, 7.61387019, 7.60770906, 7.58829091, 7.54921831,
<span class="linenos" data-linenos="19 "></span>         7.62852769, 7.67279735, 7.63743652, 7.57451658, 7.58273362,
<span class="linenos" data-linenos="20 "></span>         7.57287253, 7.62533912, 7.59833728, 7.6281886 , 7.58273084]),
<span class="linenos" data-linenos="21 "></span>  array([9.59814874, 9.62711488, 9.52207446, 9.58922312, 9.61257372,
<span class="linenos" data-linenos="22 "></span>         9.60720589, 9.59513827, 9.58761292])],
<span class="linenos" data-linenos="23 "></span> &#39;LARP6&#39;: [array([0.39605118, 0.44923688, 0.39723116, 0.36110944, 0.4094849 ,
<span class="linenos" data-linenos="24 "></span>         0.44830418, 0.40033141, 0.30914436, 0.35531045, 0.40398279,
<span class="linenos" data-linenos="25 "></span>         0.30868859, 0.42557514, 0.40645076, 0.36565866, 0.40226495,
<span class="linenos" data-linenos="26 "></span>         0.40064656, 0.40550845, 0.379309  , 0.41087431, 0.38917464]),
<span class="linenos" data-linenos="27 "></span>  array([2.35857107, 2.42493984, 2.4185328 , 2.38267342, 2.36567753,
<span class="linenos" data-linenos="28 "></span>         2.35488956, 2.38041943, 2.41088844, 2.41065989, 2.33901164,
<span class="linenos" data-linenos="29 "></span>         2.43309942, 2.42449058, 2.46759922, 2.40107789, 2.44650862,
<span class="linenos" data-linenos="30 "></span>         2.36504244, 2.4649982 , 2.37998383, 2.37317805, 2.37280365]),
<span class="linenos" data-linenos="31 "></span>  array([4.40151273, 4.39183704, 4.37988837, 4.36332155, 4.38571169,
<span class="linenos" data-linenos="32 "></span>         4.482255  , 4.45329876, 4.45922087, 4.45941655, 4.3517016 ,
<span class="linenos" data-linenos="33 "></span>         4.37072494, 4.39993687, 4.38018759, 4.46157567, 4.41463032,
<span class="linenos" data-linenos="34 "></span>         4.47669517, 4.48590511, 4.40273344, 4.42416489, 4.42481866]),
<span class="linenos" data-linenos="35 "></span>  array([6.40753908, 6.39533474, 6.43186196, 6.39155175, 6.38420249,
<span class="linenos" data-linenos="36 "></span>         6.37744387, 6.34835983, 6.45977563, 6.34673393, 6.41177516,
<span class="linenos" data-linenos="37 "></span>         6.38224613, 6.41008645, 6.40015965, 6.44797153, 6.34285174,
<span class="linenos" data-linenos="38 "></span>         6.39720648, 6.35167887, 6.4599232 , 6.3951346 , 6.43248363]),
<span class="linenos" data-linenos="39 "></span>  array([8.4330569 , 8.35690611, 8.42682504, 8.36959305, 8.43051821,
<span class="linenos" data-linenos="40 "></span>         8.37206352, 8.50770455, 8.39982997, 8.36824458, 8.43045395,
<span class="linenos" data-linenos="41 "></span>         8.34235809, 8.32681318, 8.40566378, 8.48235227, 8.34012624,
<span class="linenos" data-linenos="42 "></span>         8.42234315, 8.44505495, 8.35439482, 8.3524324 , 8.42166704]),
<span class="linenos" data-linenos="43 "></span>  array([10.39698719, 10.39177336, 10.39984058, 10.35598375, 10.4075789 ,
<span class="linenos" data-linenos="44 "></span>         10.39875562, 10.37674322, 10.37589231, 10.41706083, 10.37610904,
<span class="linenos" data-linenos="45 "></span>         10.33495458, 10.38851459, 10.45168281, 10.4151    , 10.42841167,
<span class="linenos" data-linenos="46 "></span>         10.45910684, 10.4309567 , 10.44207025, 10.43726746, 10.42861827])]}
</code></pre></div>
<h3 id="23">2.3 箱线图绘制</h3>
<h4 id="231">2.3.1 定义画板</h4>
<p>这个定义画板就很有意思了，在本系列教程中，尽量避免使用你们熟悉的plt，使用ax进行绘制，目的是能最大化自定义图形的内容。</p>
<p>首先得讲一下<code>fig</code>跟<code>ax</code>分别都是什么:</p>
<ul>
<li><code>fig</code>:</li>
</ul>
<p>Figure，就是图的外框，也叫画布，可以包括1-无穷个内框Axes</p>
<ul>
<li><code>ax</code>:</li>
</ul>
<p>Axes，就是图的内框，里面可以画各种图</p>
<ul>
<li><code>plt</code>:</li>
</ul>
<p>plt就是一整张画布，它甚至不需要这些组件，想添加什么，直接写就写了，但是用plt画图，在修改细节的时候不太友好</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">#定义画板，我们定义了一个6x3大小的子图</span>
<span class="linenos" data-linenos="2 "></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</code></pre></div>
<p>​  <br />
<img alt="png" src="../plot_2.assets/output_11_0.png" />
​    </p>
<h4 id="232">2.3.2 基本箱线图</h4>
<p>在这里，我们使用<code>ax.boxplot</code>绘制基本的箱线图，其中<code>hue_data</code>代表了需要画的目标基因，<code>hue_color</code>代表了色卡，
<code>num</code>代表了箱子放的位置，在图中我们可以看到是-0.4,0.4; 1.6,2.4……</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">#色卡</span>
<span class="linenos" data-linenos="3 "></span><span class="n">palette</span><span class="o">=</span><span class="n">sc_color</span>
<span class="linenos" data-linenos="4 "></span><span class="c1">#绘制箱线图</span>
<span class="linenos" data-linenos="5 "></span><span class="k">for</span> <span class="n">hue_data</span><span class="p">,</span><span class="n">hue_color</span><span class="p">,</span><span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">,</span><span class="n">palette</span><span class="p">,</span><span class="n">ticks_range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">),</span><span class="n">width</span><span class="p">)):</span>
<span class="linenos" data-linenos="6 "></span>    <span class="n">b1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">plot_data1</span><span class="p">[</span><span class="n">hue_data</span><span class="p">],</span> 
<span class="linenos" data-linenos="7 "></span>                  <span class="n">positions</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)))</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">)</span><span class="o">+</span><span class="n">num</span><span class="p">,</span> 
<span class="linenos" data-linenos="8 "></span>                  <span class="n">sym</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
<span class="linenos" data-linenos="9 "></span>                  <span class="n">widths</span><span class="o">=</span><span class="n">width</span><span class="p">,)</span>
</code></pre></div>
<p>​  <br />
<img alt="png" src="../plot_2.assets/output_13_0.png" />
​    </p>
<h4 id="233">2.3.3 更改箱线图的颜色</h4>
<p>在这里，我们使用<code>plt.setp</code>修改箱线图的颜色，其中，<code>boxes</code>代表了箱线图的箱子，<code>whiskers</code>代表了箱线图的误差线,
<code>cap</code>代表了箱线图上下的两个黑色帽子，也称Extreme，<code>median</code>代表了箱线图的median，就是中间橙色那根线</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">#色卡</span>
<span class="linenos" data-linenos=" 3 "></span><span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#a64d79&quot;</span><span class="p">,</span><span class="s2">&quot;#674ea7&quot;</span><span class="p">]</span>
<span class="linenos" data-linenos=" 4 "></span><span class="c1">#绘制箱线图</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">for</span> <span class="n">hue_data</span><span class="p">,</span><span class="n">hue_color</span><span class="p">,</span><span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">,</span><span class="n">palette</span><span class="p">,</span><span class="n">ticks_range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">),</span><span class="n">width</span><span class="p">)):</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="n">b1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">plot_data1</span><span class="p">[</span><span class="n">hue_data</span><span class="p">],</span> 
<span class="linenos" data-linenos=" 7 "></span>                  <span class="n">positions</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)))</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">)</span><span class="o">+</span><span class="n">num</span><span class="p">,</span> 
<span class="linenos" data-linenos=" 8 "></span>                  <span class="n">sym</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
<span class="linenos" data-linenos=" 9 "></span>                  <span class="n">widths</span><span class="o">=</span><span class="n">width</span><span class="p">,)</span>
<span class="linenos" data-linenos="10 "></span>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="s1">&#39;boxes&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">hue_color</span><span class="p">)</span>
<span class="linenos" data-linenos="11 "></span>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="s1">&#39;whiskers&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">hue_color</span><span class="p">)</span>
<span class="linenos" data-linenos="12 "></span>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="s1">&#39;caps&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">hue_color</span><span class="p">)</span>
<span class="linenos" data-linenos="13 "></span>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="s1">&#39;medians&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">hue_color</span><span class="p">)</span>
</code></pre></div>
<p>​  <br />
<img alt="png" src="../plot_2.assets/output_15_0.png" />
​    </p>
<h4 id="234">2.3.4 添加抖动的散点</h4>
<p>我们除了希望看到箱线图外，其实对散点的分布也有一定关注，于是我们将之前随机选择的20个点进行可视化</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">#色卡</span>
<span class="linenos" data-linenos=" 3 "></span><span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#a64d79&quot;</span><span class="p">,</span><span class="s2">&quot;#674ea7&quot;</span><span class="p">]</span>
<span class="linenos" data-linenos=" 4 "></span><span class="c1">#绘制箱线图</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">for</span> <span class="n">hue_data</span><span class="p">,</span><span class="n">hue_color</span><span class="p">,</span><span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">,</span><span class="n">palette</span><span class="p">,</span><span class="n">ticks_range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">),</span><span class="n">width</span><span class="p">)):</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="n">b1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">plot_data1</span><span class="p">[</span><span class="n">hue_data</span><span class="p">],</span> 
<span class="linenos" data-linenos=" 7 "></span>                  <span class="n">positions</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)))</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">)</span><span class="o">+</span><span class="n">num</span><span class="p">,</span> 
<span class="linenos" data-linenos=" 8 "></span>                  <span class="n">sym</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
<span class="linenos" data-linenos=" 9 "></span>                  <span class="n">widths</span><span class="o">=</span><span class="n">width</span><span class="p">,)</span>
<span class="linenos" data-linenos="10 "></span>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="s1">&#39;boxes&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">hue_color</span><span class="p">)</span>
<span class="linenos" data-linenos="11 "></span>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="s1">&#39;whiskers&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">hue_color</span><span class="p">)</span>
<span class="linenos" data-linenos="12 "></span>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="s1">&#39;caps&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">hue_color</span><span class="p">)</span>
<span class="linenos" data-linenos="13 "></span>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="s1">&#39;medians&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">hue_color</span><span class="p">)</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>    <span class="n">clevels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_data_random1</span><span class="p">[</span><span class="n">hue_data</span><span class="p">]))</span>
<span class="linenos" data-linenos="16 "></span>    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">clevel</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">plot_data_xs1</span><span class="p">[</span><span class="n">hue_data</span><span class="p">],</span> <span class="n">plot_data_random1</span><span class="p">[</span><span class="n">hue_data</span><span class="p">],</span> <span class="n">clevels</span><span class="p">):</span>
<span class="linenos" data-linenos="17 "></span>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">hue_color</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</code></pre></div>
<p>​  <br />
<img alt="png" src="../plot_2.assets/output_17_0.png" />
​    </p>
<h4 id="235">2.3.5 修改坐标</h4>
<p>我们现在的横坐标是数字，但是我们的目的是展示6个不同的癌症中两个基因的表达情况，所以我们需要修改一下横坐标的内容</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">#坐标轴字体</span>
<span class="linenos" data-linenos="2 "></span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">#修改横坐标</span>
<span class="linenos" data-linenos="4 "></span><span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">)),</span> <span class="n">ticks</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="linenos" data-linenos="5 "></span><span class="c1">#修改纵坐标</span>
<span class="linenos" data-linenos="6 "></span><span class="n">yticks</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()</span>
<span class="linenos" data-linenos="7 "></span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yticks</span><span class="p">[</span><span class="n">yticks</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span><span class="n">yticks</span><span class="p">[</span><span class="n">yticks</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>[&lt;matplotlib.axis.YTick at 0x7fa9737b9520&gt;,
<span class="linenos" data-linenos="2 "></span> &lt;matplotlib.axis.YTick at 0x7fa9737cad90&gt;,
<span class="linenos" data-linenos="3 "></span> &lt;matplotlib.axis.YTick at 0x7fa9737ca280&gt;,
<span class="linenos" data-linenos="4 "></span> &lt;matplotlib.axis.YTick at 0x7fa97370adc0&gt;,
<span class="linenos" data-linenos="5 "></span> &lt;matplotlib.axis.YTick at 0x7fa973705580&gt;,
<span class="linenos" data-linenos="6 "></span> &lt;matplotlib.axis.YTick at 0x7fa973705cd0&gt;,
<span class="linenos" data-linenos="7 "></span> &lt;matplotlib.axis.YTick at 0x7fa973705310&gt;,
<span class="linenos" data-linenos="8 "></span> &lt;matplotlib.axis.YTick at 0x7fa9736eebe0&gt;]
</code></pre></div>
<p>​  <br />
<img alt="png" src="../plot_2.assets/output_19_1.png" />
​    </p>
<h4 id="236">2.3.6 增加图注</h4>
<p>我们知道不同的颜色代表不同的基因，但我们也想知道具体代表什么，因此我们添加一个图注使得可视化更明显一些</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">labels</span> <span class="o">=</span> <span class="n">hue_datas</span>  <span class="c1">#legend标签列表，上面的color即是颜色列表</span>
<span class="linenos" data-linenos="2 "></span><span class="n">color</span> <span class="o">=</span> <span class="n">palette</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">#用label和color列表生成mpatches.Patch对象，它将作为句柄来生成legend</span>
<span class="linenos" data-linenos="4 "></span><span class="n">patches</span> <span class="o">=</span> <span class="p">[</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_datas</span><span class="p">))</span> <span class="p">]</span> 
<span class="linenos" data-linenos="5 "></span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patches</span><span class="p">,</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>&lt;matplotlib.legend.Legend at 0x7fa971aa54f0&gt;
</code></pre></div>
<p>​  <br />
<img alt="png" src="../plot_2.assets/output_21_1.png" />
​    </p>
<h4 id="237">2.3.7 坐标轴修改</h4>
<p>我们发现，最右边跟最上边的框框有一些难看以及多余，为此我们做一个简单的修改</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">#设置标题</span>
<span class="linenos" data-linenos="2 "></span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gene Expression&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">#设置spines可视化情况</span>
<span class="linenos" data-linenos="4 "></span><span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos" data-linenos="5 "></span><span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos" data-linenos="6 "></span><span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos" data-linenos="7 "></span><span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos" data-linenos="8 "></span>
<span class="linenos" data-linenos="9 "></span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">current_path</span><span class="o">+</span><span class="s2">&quot;figures/fig_boxplot.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</code></pre></div>
<p>​  <br />
<img alt="png" src="../plot_2.assets/output_23_0.png" />
​    </p>
<h3 id="24">2.4 小结</h3>
<p>到这里，你已经掌握箱线图的基本绘制原理，我们下期教程再见</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>
</code></pre></div>





                

  

              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fc8c2696.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>